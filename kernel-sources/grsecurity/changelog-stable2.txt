commit f9f77b161478fa4ba8ce6f3d64eea4b0d333dad6
Author: Eric Dumazet
Date: Wed Mar 19 21:02:21 2014 -0700

Upstream commit: 632623153196bf183a69686ed9c07eee98ff1bf8

tcp: syncookies: do not use getnstimeofday()

While it is true that getnstimeofday() uses about 40 cycles if TSC
is available, it can use 1600 cycles if hpet is the clocksource.

Switch to get_jiffies_64(), as this is more than enough, and
go back to 60 seconds periods.

Fixes: 8c27bd75f04f ("tcp: syncookies: reduce cookie lifetime to 128 seconds")
Signed-off-by: Eric Dumazet
Cc: Florian Westphal
Acked-by: Florian Westphal
Signed-off-by: David S. Miller

include/net/tcp.h | 11 ++++++-----
1 files changed, 6 insertions(+), 5 deletions(-)

commit 1eab38a527e74fcf503b534ad0680eb84f6172da
Author: Dave Kleikamp
Date: Fri Mar 14 10:42:01 2014 -0500

Upstream commit: 1535bd8adbdedd60a0ee62e28fd5225d66434371

sparc64: don't treat 64-bit syscall return codes as 32-bit

When checking a system call return code for an error,
linux_sparc_syscall was sign-extending the lower 32-bit value and
comparing it to -ERESTART_RESTARTBLOCK. lseek can return valid return
codes whose lower 32-bits alone would indicate a failure (such as 4G-1).
Use the whole 64-bit value to check for errors. Only the 32-bit path
should sign extend the lower 32-bit value.

Signed-off-by: Dave Kleikamp
Acked-by: Bob Picco
Acked-by: Allen Pais
Cc: David S. Miller
Cc: sparclinux@vger.kernel.org
Signed-off-by: David S. Miller

arch/sparc/kernel/syscalls.S | 4 ++--
1 files changed, 2 insertions(+), 2 deletions(-) 
